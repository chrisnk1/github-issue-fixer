# Fix: #1006 – "template alias is already taken"

## Issue
e2b-dev/E2B

#1006 – "template alias is already taken"

## Changes
1. Change the backend uniqueness constraint on template aliases from global to per-project so the same alias can exist under different API keys/projects.
2. Modify request_build to scope alias-existence checks to the authenticated project instead of checking across all templates.
3. Pass the resolved project identifier from the authenticated API key through to the build and validation logic.
4. Write unit and integration tests that create templates with identical aliases under different projects and assert success.

## Files Modified
- `backend/database/migrations/xxxx_project_alias_unique.sql`
- `backend/models/template.py`
- `backend/api/template_build.py`
- `backend/services/template_service.py`
- `tests/test_template_build.py`
- `tests/test_template_model.py`

## Implementation Details

### backend/database/migrations/xxxx_project_alias_unique.sql
This change allows the same alias to be used across different projects while maintaining uniqueness within each project, which is the expected behavior for a multi-tenant system.

### backend/models/template.py
The model now enforces per-project alias uniqueness at the database level and provides convenient methods for project-scoped queries.

### backend/api/template_build.py
The API now respects per-project alias uniqueness and ensures templates are always scoped to the authenticated project.

### backend/services/template_service.py
The service now ensures all template operations are scoped to the authenticated project and maintains per-project alias uniqueness.

### tests/test_template_build.py
These tests verify that the fix works correctly by ensuring aliases are unique only within each project, not globally.

### tests/test_template_model.py
See code comments for details

## AI-Generated Fix
This PR was generated using AI analysis with the following resources:
- [Similar issue: template alias is already taken](https://github.com/search?q=template%20alias%20is%20already%20taken&type=issues)
- [Similar issue: 400 Alias is already taken](https://github.com/search?q=400%20Alias%20is%20already%20taken&type=issues)
- [Stack Overflow: e2b "template alias is already taken" 400](https://stackoverflow.com/search?q=e2b%20%22template%20alias%20is%20already%20taken%22%20400)

---
*Generated by AI-powered GitHub Issue Fixer*
